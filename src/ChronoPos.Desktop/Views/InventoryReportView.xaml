<UserControl x:Class="ChronoPos.Desktop.Views.InventoryReportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters="clr-namespace:ChronoPos.Desktop.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="900" d:DesignWidth="1400"
             Background="{DynamicResource PageBackground}"
             Loaded="UserControl_Loaded">

    <UserControl.Resources>
        <!-- Converters -->
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:LocalizationConverter x:Key="LocalizationConverter"/>
        
        <!-- Card Style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" BlurRadius="10" ShadowDepth="2" Opacity="0.08" Direction="270"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Summary Card Style -->
        <Style x:Key="SummaryCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20,16"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" BlurRadius="8" ShadowDepth="1" Opacity="0.06" Direction="270"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Filter Button Style -->
        <Style x:Key="FilterButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#4CAF50"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                               CornerRadius="8"
                               Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#45a049"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#CCCCCC"/>
                    <Setter Property="Cursor" Value="No"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Secondary Button Style -->
        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#DDDDDD"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                               BorderBrush="{TemplateBinding BorderBrush}"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               CornerRadius="8"
                               Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#EEEEEE"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Input Style -->
        <Style x:Key="InputStyle" TargetType="Control">
            <Setter Property="Height" Value="38"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="BorderBrush" Value="#DDDDDD"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="20,15,20,20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Header -->
                <RowDefinition Height="Auto"/> <!-- Filters -->
                <RowDefinition Height="Auto"/> <!-- Summary Cards -->
                <RowDefinition Height="Auto"/> <!-- Data Grid -->
            </Grid.RowDefinitions>

            <!-- Header with Back Button -->
            <Grid Grid.Row="0" Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Back Button -->
                <Button Grid.Column="0" 
                       Command="{Binding BackToReportsHubCommand}"
                       Style="{StaticResource SecondaryButtonStyle}"
                       Width="44"
                       Height="44"
                       Padding="0"
                       Margin="0,0,15,0"
                       ToolTip="Back to Reports Hub">
                    <TextBlock Text="â†" 
                              FontSize="20" 
                              FontWeight="Bold"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"/>
                </Button>

                <StackPanel Grid.Column="1">
                    <TextBlock Text="Inventory Report" 
                              FontSize="28" 
                              FontWeight="Bold"
                              Foreground="{DynamicResource TextPrimary}"/>
                    <TextBlock Text="Monitor stock levels, track inventory movements, and analyze stock valuation" 
                              FontSize="13" 
                              Foreground="#666666"
                              Margin="0,4,0,0"/>
                </StackPanel>

                <!-- Export Buttons -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="ðŸ“„ Excel" 
                           Command="{Binding ExportToExcelCommand}"
                           Style="{StaticResource SecondaryButtonStyle}"
                           Height="34"
                           Padding="12,8"
                           FontSize="12"
                           Margin="0,0,6,0"/>
                    <Button Content="ðŸ“Š CSV" 
                           Command="{Binding ExportToCsvCommand}"
                           Style="{StaticResource SecondaryButtonStyle}"
                           Height="34"
                           Padding="12,8"
                           FontSize="12"
                           Margin="0,0,6,0"/>
                    <Button Content="ðŸ“‹ PDF" 
                           Command="{Binding ExportToPdfCommand}"
                           Style="{StaticResource SecondaryButtonStyle}"
                           Height="34"
                           Padding="12,8"
                           FontSize="12"/>
                </StackPanel>
            </Grid>

            <!-- Filters Panel -->
            <Border Grid.Row="1" Style="{StaticResource CardStyle}" Margin="0,0,0,20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Report Type Selection -->
                    <Grid Grid.Row="0" Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="Report Type" 
                                  FontSize="13" 
                                  FontWeight="SemiBold"
                                  VerticalAlignment="Center"
                                  Foreground="{DynamicResource TextPrimary}"/>

                        <ComboBox Grid.Column="1"
                                 ItemsSource="{Binding ReportTypes}"
                                 SelectedValue="{Binding SelectedReportType}"
                                 SelectedValuePath="Type"
                                 DisplayMemberPath="Name"
                                 Style="{StaticResource InputStyle}"/>
                    </Grid>

                    <!-- Date Range and Product/Category Filters -->
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" 
                                  Text="Filters" 
                                  FontSize="13" 
                                  FontWeight="SemiBold"
                                  VerticalAlignment="Center"
                                  Foreground="{DynamicResource TextPrimary}"/>

                        <!-- Start Date -->
                        <DatePicker Grid.Column="1"
                                   SelectedDate="{Binding FilterStartDate}"
                                   Style="{StaticResource InputStyle}"/>

                        <!-- End Date -->
                        <DatePicker Grid.Column="3"
                                   SelectedDate="{Binding FilterEndDate}"
                                   Style="{StaticResource InputStyle}"/>

                        <!-- Product Filter -->
                        <ComboBox Grid.Column="5"
                                 ItemsSource="{Binding Products}"
                                 SelectedValue="{Binding SelectedProductId}"
                                 SelectedValuePath="Id"
                                 DisplayMemberPath="Name"
                                 Style="{StaticResource InputStyle}"/>

                        <!-- Category Filter -->
                        <ComboBox Grid.Column="7"
                                 ItemsSource="{Binding Categories}"
                                 SelectedValue="{Binding SelectedCategoryId}"
                                 SelectedValuePath="Id"
                                 DisplayMemberPath="Name"
                                 Style="{StaticResource InputStyle}"/>

                        <!-- Action Buttons -->
                        <StackPanel Grid.Column="9" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Clear" 
                                   Command="{Binding ClearFiltersCommand}"
                                   Style="{StaticResource SecondaryButtonStyle}"
                                   Margin="0,0,10,0"/>
                            <Button Content="Load Report" 
                                   Command="{Binding LoadReportDataCommand}"
                                   Style="{StaticResource FilterButtonStyle}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>

            <!-- Summary Cards -->
            <Grid Grid.Row="2" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Total Stock Value -->
                <Border Grid.Column="0" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="Total Stock Value" 
                                  FontSize="12" 
                                  Foreground="#666666"/>
                        <TextBlock Text="{Binding TotalStockValue, StringFormat='{}{0:C}'}" 
                                  FontSize="24" 
                                  FontWeight="Bold" 
                                  Foreground="#4CAF50"
                                  Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Total Products -->
                <Border Grid.Column="2" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="Total Products" 
                                  FontSize="12" 
                                  Foreground="#666666"/>
                        <TextBlock Text="{Binding TotalProducts}" 
                                  FontSize="24" 
                                  FontWeight="Bold" 
                                  Foreground="#2196F3"
                                  Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Low Stock Items -->
                <Border Grid.Column="4" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="Low Stock Items" 
                                  FontSize="12" 
                                  Foreground="#666666"/>
                        <TextBlock Text="{Binding LowStockItems}" 
                                  FontSize="24" 
                                  FontWeight="Bold" 
                                  Foreground="#FF9800"
                                  Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Total Inward/Outward -->
                <Border Grid.Column="6" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="In/Out Movement" 
                                  FontSize="12" 
                                  Foreground="#666666"/>
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock Text="{Binding TotalInwardQty, StringFormat='â†‘{0:N0}'}" 
                                      FontSize="16" 
                                      FontWeight="SemiBold" 
                                      Foreground="#4CAF50"
                                      Margin="0,0,10,0"/>
                            <TextBlock Text="{Binding TotalOutwardQty, StringFormat='â†“{0:N0}'}" 
                                      FontSize="16" 
                                      FontWeight="SemiBold" 
                                      Foreground="#F44336"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Data Grid Area -->
            <Border Grid.Row="3" Style="{StaticResource CardStyle}">
                <Grid>
                    <!-- Loading Overlay -->
                    <Grid Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
                         Background="#F0FFFFFF"
                         Panel.ZIndex="1000">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <ProgressBar IsIndeterminate="True" Width="200" Height="4" Margin="0,0,0,10"/>
                            <TextBlock Text="Loading report..." FontSize="13" Foreground="#666666"/>
                        </StackPanel>
                    </Grid>

                    <!-- Content based on selected report type -->
                    <ContentControl>
                        <ContentControl.Style>
                            <Style TargetType="ContentControl">
                                <Style.Triggers>
                                    <!-- Stock Summary Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="StockSummary">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding StockSummaryData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         CanUserSortColumns="True"
                                                         HeadersVisibility="Column"
                                                         GridLinesVisibility="Horizontal"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Product Code" Binding="{Binding ProductCode}" Width="120"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding ProductName}" Width="*"/>
                                                        <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="150"/>
                                                        <DataGridTextColumn Header="Unit" Binding="{Binding Unit}" Width="80"/>
                                                        <DataGridTextColumn Header="Opening" Binding="{Binding OpeningStock, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Inward" Binding="{Binding InwardQty, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Outward" Binding="{Binding OutwardQty, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Closing" Binding="{Binding ClosingStock, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Unit Cost" Binding="{Binding UnitCost, StringFormat=C2}" Width="100"/>
                                                        <DataGridTextColumn Header="Stock Value" Binding="{Binding StockValue, StringFormat=C2}" Width="120"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Stock Ledger Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="StockLedger">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding StockLedgerData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Date" Binding="{Binding DateDisplay}" Width="120"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding ProductName}" Width="*"/>
                                                        <DataGridTextColumn Header="Movement Type" Binding="{Binding TransactionTypeDisplay}" Width="140"/>
                                                        <DataGridTextColumn Header="Reference Type" Binding="{Binding ReferenceTypeDisplay}" Width="140"/>
                                                        <DataGridTextColumn Header="Reference" Binding="{Binding RefNo}" Width="120"/>
                                                        <DataGridTextColumn Header="Location" Binding="{Binding LocationDisplay}" Width="120"/>
                                                        <DataGridTextColumn Header="Inward" Binding="{Binding InQtyDisplay}" Width="100"/>
                                                        <DataGridTextColumn Header="Outward" Binding="{Binding OutQtyDisplay}" Width="100"/>
                                                        <DataGridTextColumn Header="Balance" Binding="{Binding BalanceDisplay}" Width="100"/>
                                                        <DataGridTextColumn Header="Remarks" Binding="{Binding RemarksDisplay}" Width="150"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Stock Valuation Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="StockValuation">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding StockValuationData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Product Code" Binding="{Binding ProductCode}" Width="120"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="*"/>
                                                        <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="150"/>
                                                        <DataGridTextColumn Header="Unit" Binding="{Binding Unit}" Width="80"/>
                                                        <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Unit Cost" Binding="{Binding UnitCost, StringFormat=C2}" Width="100"/>
                                                        <DataGridTextColumn Header="Total Value" Binding="{Binding TotalValue, StringFormat=C2}" Width="120"/>
                                                        <DataGridTextColumn Header="% of Total" Binding="{Binding PercentageOfTotal, StringFormat=N2}" Width="100"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Low Stock Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="LowStock">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding LowStockData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Product Code" Binding="{Binding ProductCode}" Width="120"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="*"/>
                                                        <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="150"/>
                                                        <DataGridTextColumn Header="Current Qty" Binding="{Binding CurrentQty, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Reorder Level" Binding="{Binding ReorderLevel, StringFormat=N2}" Width="110"/>
                                                        <DataGridTextColumn Header="Shortage" Binding="{Binding Shortage, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Supplier" Binding="{Binding Supplier}" Width="150"/>
                                                        <DataGridTextColumn Header="Est. Reorder Value" Binding="{Binding EstimatedReorderValue, StringFormat=C2}" Width="140"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Goods Received Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="GoodsReceived">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding GoodsReceivedData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="GRN No" Binding="{Binding GrnNo}" Width="120"/>
                                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=dd/MM/yyyy}" Width="100"/>
                                                        <DataGridTextColumn Header="Supplier" Binding="{Binding Supplier}" Width="150"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="*"/>
                                                        <DataGridTextColumn Header="Qty" Binding="{Binding Qty, StringFormat=N2}" Width="80"/>
                                                        <DataGridTextColumn Header="Unit Price" Binding="{Binding UnitPrice, StringFormat=C2}" Width="100"/>
                                                        <DataGridTextColumn Header="Total" Binding="{Binding Total, StringFormat=C2}" Width="120"/>
                                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                                        <DataGridTextColumn Header="Invoice No" Binding="{Binding InvoiceNo}" Width="120"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Stock Adjustment Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="StockAdjustment">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding StockAdjustmentData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=dd/MM/yyyy}" Width="100"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="*"/>
                                                        <DataGridTextColumn Header="Previous Qty" Binding="{Binding PreviousQty, StringFormat=N2}" Width="110"/>
                                                        <DataGridTextColumn Header="New Qty" Binding="{Binding NewQty, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Difference" Binding="{Binding Difference, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Reason" Binding="{Binding Reason}" Width="150"/>
                                                        <DataGridTextColumn Header="Note" Binding="{Binding Note}" Width="200"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Stock Transfer Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="StockTransfer">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding StockTransferData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Transfer No" Binding="{Binding TransferNo}" Width="120"/>
                                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=dd/MM/yyyy}" Width="100"/>
                                                        <DataGridTextColumn Header="From" Binding="{Binding FromLocation}" Width="150"/>
                                                        <DataGridTextColumn Header="To" Binding="{Binding ToLocation}" Width="150"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="*"/>
                                                        <DataGridTextColumn Header="Qty" Binding="{Binding Qty, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Stock Aging Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="StockAging">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding StockAgingData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="*"/>
                                                        <DataGridTextColumn Header="Batch No" Binding="{Binding BatchNo}" Width="120"/>
                                                        <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Purchase Date" Binding="{Binding PurchaseDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                                                        <DataGridTextColumn Header="Days in Stock" Binding="{Binding DaysInStock}" Width="110"/>
                                                        <DataGridTextColumn Header="Expiry Date" Binding="{Binding ExpiryDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                                                        <DataGridTextColumn Header="Days to Expiry" Binding="{Binding DaysToExpiry}" Width="120"/>
                                                        <DataGridTextColumn Header="Age Category" Binding="{Binding AgeCategory}" Width="120"/>
                                                        <DataGridTextColumn Header="Total Value" Binding="{Binding TotalValue, StringFormat=C2}" Width="120"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Goods Return Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="GoodsReturn">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding GoodsReturnData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Return No" Binding="{Binding ReturnNo}" Width="120"/>
                                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=dd/MM/yyyy}" Width="100"/>
                                                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="100"/>
                                                        <DataGridTextColumn Header="Supplier" Binding="{Binding Supplier}" Width="150"/>
                                                        <DataGridTextColumn Header="Product" Binding="{Binding Product}" Width="*"/>
                                                        <DataGridTextColumn Header="Qty" Binding="{Binding Qty, StringFormat=N2}" Width="80"/>
                                                        <DataGridTextColumn Header="Reason" Binding="{Binding Reason}" Width="150"/>
                                                        <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=C2}" Width="120"/>
                                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>

                                    <!-- Category Summary Report -->
                                    <DataTrigger Binding="{Binding SelectedReportType}" Value="CategorySummary">
                                        <Setter Property="Content">
                                            <Setter.Value>
                                                <DataGrid ItemsSource="{Binding InventorySummaryData}"
                                                         AutoGenerateColumns="False"
                                                         IsReadOnly="True"
                                                         RowHeight="40">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="*"/>
                                                        <DataGridTextColumn Header="No of Items" Binding="{Binding NoOfItems}" Width="110"/>
                                                        <DataGridTextColumn Header="Total Qty" Binding="{Binding TotalQty, StringFormat=N2}" Width="110"/>
                                                        <DataGridTextColumn Header="Total Value" Binding="{Binding TotalValue, StringFormat=C2}" Width="120"/>
                                                        <DataGridTextColumn Header="Avg Cost" Binding="{Binding AvgCost, StringFormat=C2}" Width="110"/>
                                                        <DataGridTextColumn Header="% of Total" Binding="{Binding PercentageOfTotal, StringFormat=N2}" Width="100"/>
                                                        <DataGridTextColumn Header="Low Stock Items" Binding="{Binding LowStockItems}" Width="130"/>
                                                        <DataGridTextColumn Header="Out of Stock" Binding="{Binding OutOfStockItems}" Width="120"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>
                </Grid>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>
